<section class="product-page" *ngIf="product as p">

  <!-- BREADCRUMB -->
  <nav class="breadcrumb">
    <a routerLink="/">Inicio</a> /
    <a routerLink="/products">Productos</a> /
    <span>{{ p.nombre }}</span>
  </nav>

  <!-- ===================== CONTENEDOR GENERAL ====================== -->
  <div class="product-container">

    <!-- ===== THUMBNAILS ===== -->
    <aside class="gallery">
      <div
        class="thumb"
        *ngFor="let thumb of thumbnailImages; let i = index"
        [class.active]="selectedVariant === thumb"
        (click)="selectImage(thumb)"
      >
        <img
          [src]="thumb.src"
          [style.object-position]="thumb.focus || 'center'"
          [style.transform]="thumb.zoom ? 'scale(' + thumb.zoom + ')' : 'scale(1)'"
        />
      </div>
    </aside>

    <!-- ===== IMAGEN PRINCIPAL ===== -->
    <div class="main-image">
      <img
        [src]="selectedImage"
        [style.object-position]="selectedImageStyles.objectPosition"
        [style.transform]="selectedImageStyles.transform"
      />
    </div>

    <!-- ===== INFORMACIÓN ===== -->
    <div class="info">

      <div class="badge" *ngIf="p.badge" [ngClass]="p.badge">{{ p.badge }}</div>
      <div class="badge out" *ngIf="((p.stock || 0)) <= 0">Sin stock</div>
      <h1 class="title">{{ p.nombre }}</h1>

      <p class="price">{{ formatPrice(p.precio) }}</p>
      <p class="sku" *ngIf="p.sku">SKU: {{ p.sku }}</p>

      <!-- COLOR -->
      <div class="color-section">
        <p class="subtitle">Color</p>

        <div class="colors">
          <div
            class="color-circle"
            *ngFor="let chip of colorChips"
            [style.background]="chip.css"
            [class.selected]="selectedColor === chip.label"
            (click)="selectColor(chip.label)"
            [attr.title]="chip.label"
          ></div>
        </div>
      </div>

      <!-- CANTIDAD -->
      <div class="qty-section">
        <p class="subtitle">Cantidad</p>

        <div class="qty-box">
          <button (click)="decrement()" [disabled]="((p.stock || 0)) <= 0">-</button>

          <input
            type="number"
            [(ngModel)]="quantity"
            min="1"
            [max]="p.stock || 99"
            [disabled]="((p.stock || 0)) <= 0"
          />

          <button (click)="increment()" [disabled]="((p.stock || 0)) <= 0">+</button>
        </div>
      </div>

      <!-- BOTONES -->
      <button class="btn-buy" (click)="buyNow()" [disabled]="((p.stock || 0)) <= 0">Comprar Ahora</button>

      <button class="btn-cart" (click)="addToCart()" [disabled]="((p.stock || 0)) <= 0">Agregar al Carrito</button>

      <button class="favorite-btn">♡ Añadir a favoritos</button>

    </div>
  </div>

  <!-- ===================== DESCRIPCIÓN ====================== -->
  <section class="description">
    <h2>Descripción</h2>
    <p>
      {{ p.descripcion }}
    </p>
  </section>

  <!-- ===================== CARACTERÍSTICAS ====================== -->
  <section class="features">
    <h2>Características</h2>

    <p>
      {{ featureDescription }}
    </p>
  </section>

  <!-- ===================== DIMENSIONES ====================== -->
  <section class="dimensions">
    <h2>Dimensiones</h2>

    <table>
      <tr>
        <td>Alto</td>
        <td class="value">{{ displayDimensions?.alto }}</td>
      </tr>
      <tr>
        <td>Ancho</td>
        <td class="value">{{ displayDimensions?.ancho }}</td>
      </tr>
      <tr>
        <td>Profundidad</td>
        <td class="value">{{ displayDimensions?.profundidad }}</td>
      </tr>
      <tr>
        <td>Capacidad</td>
        <td class="value">{{ displayDimensions?.capacidad }}</td>
      </tr>
    </table>
  </section>

  <!-- ===================== OPINIONES ====================== -->
  <section class="reviews">
    <h2>Opiniones de los Clientes</h2>

    <div class="review" *ngFor="let r of reviews">
      <p class="review-name">{{ r.name }}</p>
      <p class="review-date">{{ r.date }}</p>

      <div class="stars">
        <span *ngFor="let s of stars; let i = index">
          {{ i < r.rating ? '★' : '☆' }}
        </span>
      </div>

      <p class="review-comment">{{ r.comment }}</p>
    </div>
  </section>

